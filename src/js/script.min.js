import"./modules/theme-manager.js";import"./modules/navigation.js";import"./modules/form-validator.js";import{BrowserCompatibilityDetector as e}from"./modules/utilities.js";import{StarfieldManager as t,ScrollSaturationController as n,WebGLParticleSystem as r,AdvancedCursorTrail as i,MagneticFieldController as o,EnhancedScrollAnimations as a,EnhancedHoverEffects as l,LoadingAnimations as s,AnimationPresetManager as c,AdvancedAnimationController as d,CursorTrailManager as m,EnhancedTiltManager as u}from"./modules/animations.js";import{GlobalScrollManager as w,ChatSystemManager as g,MapManager as f}from"./modules/features.js";document.addEventListener("DOMContentLoaded",()=>{try{window.globalScrollManager=new w,window.globalScrollManager.addHandler("header",e=>{const t=document.querySelector(".header");t&&(e>24?t.classList.add("scrolled"):t.classList.remove("scrolled"))}),window.chatSystemManager=new g,function(){try{new f}catch(e){window.CONFIG?.DEBUG&&console.error("MapManager initialization failed",e)}}(),function(){if(!window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;const e=document.createElement("style");e.textContent="\n    *, *::before, *::after {\n      animation-duration: 0.01ms !important;\n      animation-iteration-count: 1 !important;\n      transition-duration: 0.01ms !important;\n    }\n    .project-card[data-tilt]:hover,\n    .skill-card:hover,\n    .hero-cta:hover,\n    .contact-link-item:hover {\n      transition-duration: 0.1ms !important;\n      transform: none !important;\n    }\n    .cursor-trail {\n      display: none !important;\n    }\n  ",document.head.appendChild(e)}();const p=new e,h=function(e){const c=new d,w=new t;w.enableRainbowMode=!1,"low"!==e.performance.level&&"ie"!==e.browser||(w.totalIcons=Math.min(100,w.totalIcons)),c.registerAnimation("starfield",w);let g=null;if(e.features.webgl||e.features.requestAnimationFrame){const e=function(){const e=document.createElement("canvas");return e.width=window.innerWidth,e.height=window.innerHeight,e.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    z-index: -2;\n    opacity: 0.3;\n  ",e}();document.body.appendChild(e),g=new r(e)}let f=null;!e.features.touchEvents&&e.features.addEventListener&&(f=new i);const p=new o;(e.features.touchEvents||"low"===e.performance.level)&&(p.strength=25,p.maxDistance=100),(new a).init(),(new l).init(),(new s).init();const h=new n,v=new m,C=new u;return c.registerAnimation("particles",g),c.registerAnimation("cursorTrail",f),c.registerAnimation("magneticField",p),c.registerAnimation("legacyCursorTrail",v),c.registerAnimation("tiltEffects",C),{advancedAnimationController:c,starfieldManager:w,webglParticleSystem:g,advancedCursorTrail:f,magneticFieldController:p,scrollSaturationController:h,cursorTrailManager:v,enhancedTiltManager:C}}(p),v=function(e,t){const n=new c,r={starfield:t.starfieldManager,cursorTrail:t.advancedCursorTrail,magneticField:t.magneticFieldController,particleSystem:t.webglParticleSystem};let i="balanced";return"low"===e.performance.level||"ie"===e.browser?i="minimal":"high"!==e.performance.level||e.features.touchEvents||(i="enhanced"),n.currentPreset=i,n.init(r),n}(p,h);!function(e){document.addEventListener("keydown",t=>{if(t.ctrlKey||t.metaKey)switch(t.key){case"r":t.preventDefault(),e.starfieldManager.toggleRainbowMode();break;case"t":t.preventDefault(),e.advancedCursorTrail&&e.advancedCursorTrail.setActive(!e.advancedCursorTrail.isActive);break;case"m":t.preventDefault(),e.magneticFieldController.setActive(!e.magneticFieldController.isActive)}})}(h),function(e,t){window.getAnimationMetrics=()=>({starfield:e.starfieldManager.getPerformanceMetrics(),global:e.advancedAnimationController.getGlobalMetrics(),scrollSaturation:e.scrollSaturationController.getState(),systems:{webglSupported:e.webglParticleSystem?.isWebGLSupported,activeAnimations:e.advancedAnimationController.animations.size,currentPreset:t.currentPreset}}),window.animationControls={toggleRainbow:()=>e.starfieldManager.toggleRainbowMode(),toggleCursorTrail:()=>e.advancedCursorTrail?.setActive(!e.advancedCursorTrail.isActive),toggleMagnetic:()=>e.magneticFieldController.setActive(!e.magneticFieldController.isActive),toggleScrollSaturation:t=>e.scrollSaturationController.setEnabled(!1!==t),refreshScrollSaturation:()=>{e.scrollSaturationController.refreshBaseValues(),e.scrollSaturationController.update(window.scrollY)},getScrollSaturationState:()=>e.scrollSaturationController.getState(),setPreset:e=>t.setPreset(e),getPresets:()=>Object.keys(t.presets)}}(h,v),window.analytics&&window.analytics.track("page_view",{event_category:"engagement",event_label:"home_page"})}catch(p){window.CONFIG?.DEBUG&&console.error("Initialization error",p)}}),"undefined"!=typeof window&&(window.debounce=function(e,t){let n;return function(...r){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),e.apply(this,r)},t)}},window.throttle=function(e,t){let n=!1;return function(...r){n||(e.apply(this,r),n=!0,setTimeout(()=>{n=!1},t))}},window.isInViewport=function(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)});